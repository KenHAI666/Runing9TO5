<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>後台文章管理</title>
<link rel="stylesheet" href="/static/style.css">
<script>
function preview() {
    const content = document.getElementById("content").value;
    fetch("/preview", {method:"POST", body: new URLSearchParams({content})})
        .then(r => r.text())
        .then(html => {
            document.getElementById("preview").innerHTML = html;
        });
}
function insertMarkdown(tagStart, tagEnd) {
    const textarea = document.getElementById("content");
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const text = textarea.value;
    textarea.value = text.slice(0,start) + tagStart + text.slice(start,end) + tagEnd + text.slice(end);
}
</script>
</head>
<body>
<h1>文章後台</h1>
<form method="POST">
<label>標題：<input type="text" name="title" required></label><br>
<label>分類：<input type="text" name="categories"></label><br>
<label>標籤（逗號分隔）：<input type="text" name="tags"></label><br>
<button type="button" onclick="insertMarkdown('# ','')">H1</button>
<button type="button" onclick="insertMarkdown('## ','')">H2</button>
<button type="button" onclick="insertMarkdown('### ','')">H3</button>
<button type="button" onclick="insertMarkdown('**','**')">粗體</button>
<button type="button" onclick="insertMarkdown('|','|')">表格欄位</button><br>
<textarea id="content" name="content" rows="15" cols="80"></textarea><br>
<button type="button" onclick="preview()">預覽</button>
<button type="submit">確認發佈</button>
</form>
<h2>預覽</h2>
<div id="preview" style="border:1px solid #ccc; padding:10px;"></div>
</body>
</html>
